<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/selection.js | NGL Viewer API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header><span>NGL@0.10.5-3</span>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a href="./../gallery/index.html">Gallery</a><a data-ice="repoURL" href="https://github.com/arose/ngl.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/script.js~Script.html">Script</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/selection.js~Selection.html">Selection</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-binarySearchIndexOf">binarySearchIndexOf</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Browser">Browser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ColormakerRegistry">ColormakerRegistry</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ExtensionFragDepth">ExtensionFragDepth</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Mobile">Mobile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Version">Version</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Box3">Box3</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/core/BufferGeometry">BufferGeometry</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">Char</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Color">Color</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Euler">Euler</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">Float</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">Integer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Matrix3">Matrix3</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Matrix4">Matrix4</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Plane">Plane</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Quaternion">Quaternion</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://millermedeiros.github.io/js-signals/docs/symbols/Signal.html">Signal</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray">TypedArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Vector2">Vector2</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Vector3">Vector3</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">align</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-superpose">superpose</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">animation</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~AnimationList.html">AnimationList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~MoveAnimation.html">MoveAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~RockAnimation.html">RockAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~RotateAnimation.html">RotateAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~SpinAnimation.html">SpinAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~TimeoutAnimation.html">TimeoutAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~ValueAnimation.html">ValueAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~ZoomAnimation.html">ZoomAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/animation/animation.js~Animation.html">Animation</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">buffer</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/arrow-buffer.js~ArrowBuffer.html">ArrowBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/cone-buffer.js~ConeBuffer.html">ConeBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/conegeometry-buffer.js~ConeGeometryBuffer.html">ConeGeometryBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/contour-buffer.js~ContourBuffer.html">ContourBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/cylinder-buffer.js~CylinderBuffer.html">CylinderBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/cylindergeometry-buffer.js~CylinderGeometryBuffer.html">CylinderGeometryBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/cylinderimpostor-buffer.js~CylinderImpostorBuffer.html">CylinderImpostorBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/doublesided-buffer.js~DoubleSidedBuffer.html">DoubleSidedBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/ellipsoid-buffer.js~EllipsoidBuffer.html">EllipsoidBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/ellipsoidgeometry-buffer.js~EllipsoidGeometryBuffer.html">EllipsoidGeometryBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/hyperballstick-buffer.js~HyperballStickBuffer.html">HyperballStickBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/hyperballstickimpostor-buffer.js~HyperballStickImpostorBuffer.html">HyperballStickImpostorBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/image-buffer.js~ImageBuffer.html">ImageBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/line-buffer.js~LineBuffer.html">LineBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/mesh-buffer.js~MeshBuffer.html">MeshBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/point-buffer.js~PointBuffer.html">PointBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/ribbon-buffer.js~RibbonBuffer.html">RibbonBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/sphere-buffer.js~SphereBuffer.html">SphereBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/spheregeometry-buffer.js~SphereGeometryBuffer.html">SphereGeometryBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/sphereimpostor-buffer.js~SphereImpostorBuffer.html">SphereImpostorBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/surface-buffer.js~SurfaceBuffer.html">SurfaceBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/text-buffer.js~TextBuffer.html">TextBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/trace-buffer.js~TraceBuffer.html">TraceBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/tubemesh-buffer.js~TubeMeshBuffer.html">TubeMeshBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/vector-buffer.js~VectorBuffer.html">VectorBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/alignedbox-buffer.js~AlignedBoxBuffer.html">AlignedBoxBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/box-buffer.js~BoxBuffer.html">BoxBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/buffer.js~Buffer.html">Buffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/geometry-buffer.js~GeometryBuffer.html">GeometryBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/mapped-buffer.js~MappedBuffer.html">MappedBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/quad-buffer.js~QuadBuffer.html">QuadBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-BufferParameters">BufferParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TextBufferParameters">TextBufferParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">color</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/atomindex-colormaker.js~AtomindexColormaker.html">AtomindexColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/bfactor-colormaker.js~BfactorColormaker.html">BfactorColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/chainid-colormaker.js~ChainidColormaker.html">ChainidColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/chainindex-colormaker.js~ChainindexColormaker.html">ChainindexColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/chainname-colormaker.js~ChainnameColormaker.html">ChainnameColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/colormaker-registry.js~ColormakerRegistry.html">ColormakerRegistry</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/densityfit-colormaker.js~DensityfitColormaker.html">DensityfitColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/electrostatic-colormaker.js~ElectrostaticColormaker.html">ElectrostaticColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/element-colormaker.js~ElementColormaker.html">ElementColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/entityindex-colormaker.js~EntityindexColormaker.html">EntityindexColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/entitytype-colormaker.js~EntitytypeColormaker.html">EntitytypeColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/geoquality-colormaker.js~GeoqualityColormaker.html">GeoqualityColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/hydrophobicity-colormaker.js~HydrophobicityColormaker.html">HydrophobicityColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/modelindex-colormaker.js~ModelindexColormaker.html">ModelindexColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/moleculetype-colormaker.js~MoleculetypeColormaker.html">MoleculetypeColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/occupancy-colormaker.js~OccupancyColormaker.html">OccupancyColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/random-colormaker.js~RandomColormaker.html">RandomColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/residueindex-colormaker.js~ResidueindexColormaker.html">ResidueindexColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/resname-colormaker.js~ResnameColormaker.html">ResnameColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/selection-colormaker.js~SelectionColormaker.html">SelectionColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/sstruc-colormaker.js~SstrucColormaker.html">SstrucColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/uniform-colormaker.js~UniformColormaker.html">UniformColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/value-colormaker.js~ValueColormaker.html">ValueColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/volume-colormaker.js~VolumeColormaker.html">VolumeColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/color/colormaker.js~Colormaker.html">Colormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-ColormakerParameters">ColormakerParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">component</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/annotation.js~Annotation.html">Annotation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/representation-component.js~RepresentationComponent.html">RepresentationComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/script-component.js~ScriptComponent.html">ScriptComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/shape-component.js~ShapeComponent.html">ShapeComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/structure-component.js~StructureComponent.html">StructureComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/surface-component.js~SurfaceComponent.html">SurfaceComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/trajectory-component.js~TrajectoryComponent.html">TrajectoryComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/volume-component.js~VolumeComponent.html">VolumeComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/component/component.js~Component.html">Component</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-ComponentParameters">ComponentParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-ComponentSignals">ComponentSignals</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-RepresentationComponentSignals">RepresentationComponentSignals</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StructureComponentSignals">StructureComponentSignals</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TrajectoryComponentParameters">TrajectoryComponentParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TrajectoryComponentSignals">TrajectoryComponentSignals</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">controls</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/animation-controls.js~AnimationControls.html">AnimationControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/component-controls.js~ComponentControls.html">ComponentControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/mouse-actions.js~MouseActions.html">MouseActions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/mouse-controls.js~MouseControls.html">MouseControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/picking-controls.js~PickingControls.html">PickingControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/picking-proxy.js~PickingProxy.html">PickingProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/trackball-controls.js~TrackballControls.html">TrackballControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/viewer-controls.js~ViewerControls.html">ViewerControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TriggerString">TriggerString</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-PickingData">PickingData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-OrientationMatrix">OrientationMatrix</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">geometry</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/geometry/shape.js~Shape.html">Shape</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">loader</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/loader/loader.js~Loader.html">Loader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/loader/parser-loader.js~ParserLoader.html">ParserLoader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/loader/plugin-loader.js~PluginLoader.html">PluginLoader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/loader/script-loader.js~ScriptLoader.html">ScriptLoader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-autoLoad">autoLoad</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-LoaderParameters">LoaderParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">math</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/math/principal-axes.js~PrincipalAxes.html">PrincipalAxes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-quicksortIP">quicksortIP</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-lineLineIntersect">lineLineIntersect</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">parser</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/parser/csv-parser.js~CsvParser.html">CsvParser</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">proxy</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/atom-proxy.js~AtomProxy.html">AtomProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/bond-proxy.js~BondProxy.html">BondProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/chain-proxy.js~ChainProxy.html">ChainProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/model-proxy.js~ModelProxy.html">ModelProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/polymer.js~Polymer.html">Polymer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/residue-proxy.js~ResidueProxy.html">ResidueProxy</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">representation</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/axes-representation.js~AxesRepresentation.html">AxesRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/backbone-representation.js~BackboneRepresentation.html">BackboneRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/ballandstick-representation.js~BallAndStickRepresentation.html">BallAndStickRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/base-representation.js~BaseRepresentation.html">BaseRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/buffer-representation.js~BufferRepresentation.html">BufferRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/cartoon-representation.js~CartoonRepresentation.html">CartoonRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/contact-representation.js~ContactRepresentation.html">ContactRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/distance-representation.js~DistanceRepresentation.html">DistanceRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/dot-representation.js~DotRepresentation.html">DotRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/helixorient-representation.js~HelixorientRepresentation.html">HelixorientRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/hyperball-representation.js~HyperballRepresentation.html">HyperballRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/label-representation.js~LabelRepresentation.html">LabelRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/licorice-representation.js~LicoriceRepresentation.html">LicoriceRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/line-representation.js~LineRepresentation.html">LineRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/molecularsurface-representation.js~MolecularSurfaceRepresentation.html">MolecularSurfaceRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/point-representation.js~PointRepresentation.html">PointRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/ribbon-representation.js~RibbonRepresentation.html">RibbonRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/rocket-representation.js~RocketRepresentation.html">RocketRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/rope-representation.js~RopeRepresentation.html">RopeRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/slice-representation.js~SliceRepresentation.html">SliceRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/spacefill-representation.js~SpacefillRepresentation.html">SpacefillRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/surface-representation.js~SurfaceRepresentation.html">SurfaceRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/trace-representation.js~TraceRepresentation.html">TraceRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/trajectory-representation.js~TrajectoryRepresentation.html">TrajectoryRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/tube-representation.js~TubeRepresentation.html">TubeRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/unitcell-representation.js~UnitcellRepresentation.html">UnitcellRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/validation-representation.js~ValidationRepresentation.html">ValidationRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/representation/representation.js~Representation.html">Representation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/representation/structure-representation.js~StructureRepresentation.html">StructureRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-BallAndStickRepresentationParameters">BallAndStickRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-DistanceRepresentationParameters">DistanceRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-DotRepresentationParameters">DotRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-LabelRepresentationParameters">LabelRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-RepresentationParameters">RepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-SliceRepresentationParameters">SliceRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StructureRepresentationParameters">StructureRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-SurfaceRepresentationParameters">SurfaceRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TrajectoryRepresentationParameters">TrajectoryRepresentationParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">stage</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/stage/mouse-observer.js~MouseObserver.html">MouseObserver</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/stage/stage.js~Stage.html">Stage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-MouseSignals">MouseSignals</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StageParameters">StageParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StageSignals">StageSignals</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">store</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/atom-store.js~AtomStore.html">AtomStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/atom-type.js~AtomType.html">AtomType</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/bond-store.js~BondStore.html">BondStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/chain-store.js~ChainStore.html">ChainStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/model-store.js~ModelStore.html">ModelStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/residue-store.js~ResidueStore.html">ResidueStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/residue-type.js~ResidueType.html">ResidueType</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/store/store.js~Store.html">Store</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">structure</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/structure/entity.js~Entity.html">Entity</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/structure/structure-view.js~StructureView.html">StructureView</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/structure/structure.js~Structure.html">Structure</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-assignResidueTypeBonds">assignResidueTypeBonds</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StructureExtraData">StructureExtraData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StructureHeader">StructureHeader</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">surface</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/surface/molecular-surface.js~MolecularSurface.html">MolecularSurface</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/surface/surface.js~Surface.html">Surface</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/surface/volume.js~Volume.html">Volume</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-AVHash">AVHash</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-MolecularSurfaceParameters">MolecularSurfaceParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">symmetry</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/symmetry/assembly.js~Assembly.html">Assembly</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/symmetry/unitcell.js~Unitcell.html">Unitcell</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">trajectory</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/trajectory/trajectory-player.js~TrajectoryPlayer.html">TrajectoryPlayer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/trajectory/trajectory.js~Trajectory.html">Trajectory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TrajectoryPlayerParameters">TrajectoryPlayerParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TrajectoryParameters">TrajectoryParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">utils</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/bitarray.js~BitArray.html">BitArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/counter.js~Counter.html">Counter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/io-buffer.js~IOBuffer.html">IOBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/netcdf-reader.js~NetcdfReader.html">NetcdfReader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/utils/picker.js~Picker.html">Picker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/utils/picker.js~ShapePicker.html">ShapePicker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-BinaryHeap">BinaryHeap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Kdtree">Kdtree</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">viewer</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeImage">makeImage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Viewer">Viewer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-ImageParameters">ImageParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">writer</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/writer/pdb-writer.js~PdbWriter.html">PdbWriter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/writer/writer.js~Writer.html">Writer</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/selection.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/**
 * @file Selection
 * @author Alexander Rose &lt;alexander.rose@weirdbyte.de&gt;
 * @private
 */

import Signal from &apos;../lib/signals.es6.js&apos;

import { binarySearchIndexOf, rangeInSortedArray } from &apos;./utils.js&apos;

const kwd = {
  PROTEIN: 1,
  NUCLEIC: 2,
  RNA: 3,
  DNA: 4,
  POLYMER: 5,
  WATER: 6,
  HELIX: 7,
  SHEET: 8,
  TURN: 9,
  BACKBONE: 10,
  SIDECHAIN: 11,
  ALL: 12,
  HETERO: 13,
  ION: 14,
  SACCHARIDE: 15,
  SUGAR: 15,
  BONDED: 16,
  RING: 17
}

const SelectAllKeyword = [ &apos;*&apos;, &apos;&apos;, &apos;ALL&apos; ]

const AtomOnlyKeywords = [
  kwd.BACKBONE, kwd.SIDECHAIN, kwd.BONDED, kwd.RING
]

const ChainKeywords = [
  kwd.POLYMER, kwd.WATER
]

const SmallResname = [ &apos;ALA&apos;, &apos;GLY&apos;, &apos;SER&apos; ]
const NucleophilicResname = [ &apos;CYS&apos;, &apos;SER&apos;, &apos;THR&apos; ]
const HydrophobicResname = [ &apos;ALA&apos;, &apos;ILE&apos;, &apos;LEU&apos;, &apos;MET&apos;, &apos;PHE&apos;, &apos;PRO&apos;, &apos;TRP&apos;, &apos;VAL&apos; ]
const AromaticResname = [ &apos;PHE&apos;, &apos;TRP&apos;, &apos;TYR&apos;, &apos;HIS&apos; ]
const AmideResname = [ &apos;ASN&apos;, &apos;GLN&apos; ]
const AcidicResname = [ &apos;ASP&apos;, &apos;GLU&apos; ]
const BasicResname = [ &apos;ARG&apos;, &apos;HIS&apos;, &apos;LYS&apos; ]
const ChargedResname = [ &apos;ARG&apos;, &apos;ASP&apos;, &apos;GLU&apos;, &apos;HIS&apos;, &apos;LYS&apos; ]
const PolarResname = [ &apos;ASN&apos;, &apos;ARG&apos;, &apos;ASP&apos;, &apos;CYS&apos;, &apos;GLY&apos;, &apos;GLN&apos;, &apos;GLU&apos;, &apos;HIS&apos;, &apos;LYS&apos;, &apos;SER&apos;, &apos;THR&apos;, &apos;TYR&apos; ]
const NonpolarResname = [ &apos;ALA&apos;, &apos;ILE&apos;, &apos;LEU&apos;, &apos;MET&apos;, &apos;PHE&apos;, &apos;PRO&apos;, &apos;TRP&apos;, &apos;VAL&apos; ]
const CyclicResname = [ &apos;HIS&apos;, &apos;PHE&apos;, &apos;PRO&apos;, &apos;TRP&apos;, &apos;TYR&apos; ]
const AliphaticResname = [ &apos;ALA&apos;, &apos;GLY&apos;, &apos;ILE&apos;, &apos;LEU&apos;, &apos;VAL&apos; ]

function atomTestFn (a, s) {
    // returning -1 means the rule is not applicable
  if (s.atomname === undefined &amp;&amp; s.element === undefined &amp;&amp;
            s.altloc === undefined &amp;&amp; s.atomindex === undefined &amp;&amp;
            s.keyword === undefined &amp;&amp; s.inscode === undefined &amp;&amp;
            s.resname === undefined &amp;&amp; s.sstruc === undefined &amp;&amp;
            s.resno === undefined &amp;&amp; s.chainname === undefined &amp;&amp;
            s.model === undefined
    ) return -1

  if (s.keyword !== undefined) {
    if (s.keyword === kwd.BACKBONE &amp;&amp; !a.isBackbone()) return false
    if (s.keyword === kwd.SIDECHAIN &amp;&amp; !a.isSidechain()) return false
    if (s.keyword === kwd.BONDED &amp;&amp; !a.isBonded()) return false
    if (s.keyword === kwd.RING &amp;&amp; !a.isRing()) return false

    if (s.keyword === kwd.HETERO &amp;&amp; !a.isHetero()) return false
    if (s.keyword === kwd.PROTEIN &amp;&amp; !a.isProtein()) return false
    if (s.keyword === kwd.NUCLEIC &amp;&amp; !a.isNucleic()) return false
    if (s.keyword === kwd.RNA &amp;&amp; !a.isRna()) return false
    if (s.keyword === kwd.DNA &amp;&amp; !a.isDna()) return false
    if (s.keyword === kwd.POLYMER &amp;&amp; !a.isPolymer()) return false
    if (s.keyword === kwd.WATER &amp;&amp; !a.isWater()) return false
    if (s.keyword === kwd.HELIX &amp;&amp; !a.isHelix()) return false
    if (s.keyword === kwd.SHEET &amp;&amp; !a.isSheet()) return false
    if (s.keyword === kwd.TURN &amp;&amp; !a.isTurn()) return false
    if (s.keyword === kwd.ION &amp;&amp; !a.isIon()) return false
    if (s.keyword === kwd.SACCHARIDE &amp;&amp; !a.isSaccharide()) return false
  }

  if (s.atomname !== undefined &amp;&amp; s.atomname !== a.atomname) return false
  if (s.element !== undefined &amp;&amp; s.element !== a.element) return false
  if (s.altloc !== undefined &amp;&amp; s.altloc !== a.altloc) return false

  if (s.atomindex !== undefined &amp;&amp;
            binarySearchIndexOf(s.atomindex, a.index) &lt; 0
    ) return false

  if (s.resname !== undefined) {
    if (Array.isArray(s.resname)) {
      if (!s.resname.includes(a.resname)) return false
    } else {
      if (s.resname !== a.resname) return false
    }
  }
  if (s.sstruc !== undefined &amp;&amp; s.sstruc !== a.sstruc) return false
  if (s.resno !== undefined) {
    if (Array.isArray(s.resno) &amp;&amp; s.resno.length === 2) {
      if (s.resno[0] &gt; a.resno || s.resno[1] &lt; a.resno) return false
    } else {
      if (s.resno !== a.resno) return false
    }
  }
  if (s.inscode !== undefined &amp;&amp; s.inscode !== a.inscode) return false

  if (s.chainname !== undefined &amp;&amp; s.chainname !== a.chainname) return false
  if (s.model !== undefined &amp;&amp; s.model !== a.modelIndex) return false

  return true
}

function residueTestFn (r, s) {
    // returning -1 means the rule is not applicable
  if (s.resname === undefined &amp;&amp; s.resno === undefined &amp;&amp; s.inscode === undefined &amp;&amp;
            s.sstruc === undefined &amp;&amp; s.model === undefined &amp;&amp; s.chainname === undefined &amp;&amp;
            s.atomindex === undefined &amp;&amp;
            (s.keyword === undefined || AtomOnlyKeywords.includes(s.keyword))
    ) return -1

  if (s.keyword !== undefined) {
    if (s.keyword === kwd.HETERO &amp;&amp; !r.isHetero()) return false
    if (s.keyword === kwd.PROTEIN &amp;&amp; !r.isProtein()) return false
    if (s.keyword === kwd.NUCLEIC &amp;&amp; !r.isNucleic()) return false
    if (s.keyword === kwd.RNA &amp;&amp; !r.isRna()) return false
    if (s.keyword === kwd.DNA &amp;&amp; !r.isDna()) return false
    if (s.keyword === kwd.POLYMER &amp;&amp; !r.isPolymer()) return false
    if (s.keyword === kwd.WATER &amp;&amp; !r.isWater()) return false
    if (s.keyword === kwd.HELIX &amp;&amp; !r.isHelix()) return false
    if (s.keyword === kwd.SHEET &amp;&amp; !r.isSheet()) return false
    if (s.keyword === kwd.TURN &amp;&amp; !r.isTurn()) return false
    if (s.keyword === kwd.ION &amp;&amp; !r.isIon()) return false
    if (s.keyword === kwd.SACCHARIDE &amp;&amp; !r.isSaccharide()) return false
  }

  if (s.atomindex !== undefined &amp;&amp;
            rangeInSortedArray(s.atomindex, r.atomOffset, r.atomEnd) === 0
    ) return false

  if (s.resname !== undefined) {
    if (Array.isArray(s.resname)) {
      if (!s.resname.includes(r.resname)) return false
    } else {
      if (s.resname !== r.resname) return false
    }
  }
  if (s.sstruc !== undefined &amp;&amp; s.sstruc !== r.sstruc) return false
  if (s.resno !== undefined) {
    if (Array.isArray(s.resno) &amp;&amp; s.resno.length === 2) {
      if (s.resno[0] &gt; r.resno || s.resno[1] &lt; r.resno) return false
    } else {
      if (s.resno !== r.resno) return false
    }
  }
  if (s.inscode !== undefined &amp;&amp; s.inscode !== r.inscode) return false

  if (s.chainname !== undefined &amp;&amp; s.chainname !== r.chainname) return false
  if (s.model !== undefined &amp;&amp; s.model !== r.modelIndex) return false

  return true
}

function chainTestFn (c, s) {
    // returning -1 means the rule is not applicable
  if (s.chainname === undefined &amp;&amp; s.model === undefined &amp;&amp; s.atomindex === undefined &amp;&amp;
            (s.keyword === undefined || !ChainKeywords.includes(s.keyword) || !c.entity)
    ) return -1

  if (s.keyword !== undefined) {
    if (s.keyword === kwd.POLYMER &amp;&amp; !c.entity.isPolymer()) return false
    if (s.keyword === kwd.WATER &amp;&amp; !c.entity.isWater()) return false
  }

  if (s.atomindex !== undefined &amp;&amp;
            rangeInSortedArray(s.atomindex, c.atomOffset, c.atomEnd) === 0
    ) return false

  if (s.chainname !== undefined &amp;&amp; s.chainname !== c.chainname) return false

  if (s.model !== undefined &amp;&amp; s.model !== c.modelIndex) return false

  return true
}

function modelTestFn (m, s) {
    // returning -1 means the rule is not applicable
  if (s.model === undefined &amp;&amp; s.atomindex === undefined) return -1

  if (s.atomindex !== undefined &amp;&amp;
            rangeInSortedArray(s.atomindex, m.atomOffset, m.atomEnd) === 0
    ) return false

  if (s.model !== undefined &amp;&amp; s.model !== m.index) return false

  return true
}

/**
 * Selection
 */
class Selection {
    /**
     * Create Selection
     * @param {String} string - selection string, see {@tutorial selection-language}
     */
  constructor (string) {
    this.signals = {
      stringChanged: new Signal()
    }

    this.setString(string)
  }

  get type () { return &apos;selection&apos; }

  setString (string, silent) {
    if (string === undefined) string = this.string || &apos;&apos;
    if (string === this.string) return

        //

    try {
      this.parse(string)
    } catch (e) {
            // Log.error( e.stack );
      this.selection = { &apos;error&apos;: e.message }
    }

    this.string = string

    this.test = this.makeAtomTest()
    this.residueTest = this.makeResidueTest()
    this.chainTest = this.makeChainTest()
    this.modelTest = this.makeModelTest()

    this.atomOnlyTest = this.makeAtomTest(true)
    this.residueOnlyTest = this.makeResidueTest(true)
    this.chainOnlyTest = this.makeChainTest(true)
    this.modelOnlyTest = this.makeModelTest(true)

    if (!silent) {
      this.signals.stringChanged.dispatch(this.string)
    }
  }

  parse (string) {
    this.selection = {
      operator: undefined,
      rules: []
    }

    if (!string) return

    let selection = this.selection
    let newSelection, oldSelection
    const selectionStack = []

    string = string.replace(/\(/g, &apos; ( &apos;).replace(/\)/g, &apos; ) &apos;).trim()
    if (string.charAt(0) === &apos;(&apos; &amp;&amp; string.substr(-1) === &apos;)&apos;) {
      string = string.slice(1, -1).trim()
    }
    const chunks = string.split(/\s+/)

        // Log.log( string, chunks )

    const createNewContext = operator =&gt; {
      newSelection = {
        operator: operator,
        rules: []
      }
      if (selection === undefined) {
        selection = newSelection
        this.selection = newSelection
      } else {
        selection.rules.push(newSelection)
        selectionStack.push(selection)
        selection = newSelection
      }
    }

    const getPrevContext = function (operator) {
      oldSelection = selection
      selection = selectionStack.pop()
      if (selection === undefined) {
        createNewContext(operator)
        pushRule(oldSelection)
      }
    }

    const pushRule = function (rule) {
      selection.rules.push(rule)
    }

    let not

    for (let i = 0; i &lt; chunks.length; ++i) {
      const c = chunks[ i ]
      const cu = c.toUpperCase()

            // handle parens

      if (c === &apos;(&apos;) {
                // Log.log( &quot;(&quot; );

        not = false
        createNewContext()
        continue
      } else if (c === &apos;)&apos;) {
                // Log.log( &quot;)&quot; );

        getPrevContext()
        if (selection.negate) {
          getPrevContext()
        }
        continue
      }

            // leave &apos;not&apos; context

      if (not &gt; 0) {
        if (cu === &apos;NOT&apos;) {
          not = 1
        } else if (not === 1) {
          not = 2
        } else if (not === 2) {
          not = false
          getPrevContext()
        } else {
          throw new Error(&quot;something went wrong with &apos;not&apos;&quot;)
        }
      }

            // handle logic operators

      if (cu === &apos;AND&apos;) {
                // Log.log( &quot;AND&quot; );

        if (selection.operator === &apos;OR&apos;) {
          const lastRule = selection.rules.pop()
          createNewContext(&apos;AND&apos;)
          pushRule(lastRule)
        } else {
          selection.operator = &apos;AND&apos;
        }
        continue
      } else if (cu === &apos;OR&apos;) {
                // Log.log( &quot;OR&quot; );

        if (selection.operator === &apos;AND&apos;) {
          getPrevContext(&apos;OR&apos;)
        } else {
          selection.operator = &apos;OR&apos;
        }
        continue
      } else if (c.toUpperCase() === &apos;NOT&apos;) {
                // Log.log( &quot;NOT&quot;, j );

        not = 1
        createNewContext()
        selection.negate = true
        continue
      } else {

                // Log.log( &quot;chunk&quot;, c, j, selection );

      }

            // handle keyword attributes

      const keyword = kwd[ cu ]
      if (keyword !== undefined) {
        pushRule({ keyword })
        continue
      }

      if (cu === &apos;HYDROGEN&apos;) {
        pushRule({ element: &apos;H&apos; })
        continue
      }

      if (cu === &apos;SMALL&apos;) {
        pushRule({ resname: SmallResname })
        continue
      }

      if (cu === &apos;NUCLEOPHILIC&apos;) {
        pushRule({ resname: NucleophilicResname })
        continue
      }

      if (cu === &apos;HYDROPHOBIC&apos;) {
        pushRule({ resname: HydrophobicResname })
        continue
      }

      if (cu === &apos;AROMATIC&apos;) {
        pushRule({ resname: AromaticResname })
        continue
      }

      if (cu === &apos;AMIDE&apos;) {
        pushRule({ resname: AmideResname })
        continue
      }

      if (cu === &apos;ACIDIC&apos;) {
        pushRule({ resname: AcidicResname })
        continue
      }

      if (cu === &apos;BASIC&apos;) {
        pushRule({ resname: BasicResname })
        continue
      }

      if (cu === &apos;CHARGED&apos;) {
        pushRule({ resname: ChargedResname })
        continue
      }

      if (cu === &apos;POLAR&apos;) {
        pushRule({ resname: PolarResname })
        continue
      }

      if (cu === &apos;NONPOLAR&apos;) {
        pushRule({ resname: NonpolarResname })
        continue
      }

      if (cu === &apos;CYCLIC&apos;) {
        pushRule({ resname: CyclicResname })
        continue
      }

      if (cu === &apos;ALIPHATIC&apos;) {
        pushRule({ resname: AliphaticResname })
        continue
      }

      if (cu === &apos;SIDECHAINATTACHED&apos;) {
        pushRule({
          operator: &apos;OR&apos;,
          rules: [
                        { keyword: kwd.SIDECHAIN },
            {
              operator: &apos;AND&apos;,
              negate: false,
              rules: [
                                { keyword: kwd.PROTEIN },
                {
                  operator: &apos;OR&apos;,
                  negate: false,
                  rules: [
                                        { atomname: &apos;CA&apos; },
                                        { atomname: &apos;BB&apos; }
                  ]
                }
              ]
            },
            {
              operator: &apos;AND&apos;,
              negate: false,
              rules: [
                                { resname: &apos;PRO&apos; },
                                { atomname: &apos;N&apos; }
              ]
            },
            {
              operator: &apos;AND&apos;,
              negate: false,
              rules: [
                                { keyword: kwd.NUCLEIC },
                {
                  operator: &apos;OR&apos;,
                  negate: true,
                  rules: [
                                        { atomname: &apos;P&apos; },
                                        { atomname: &apos;OP1&apos; },
                                        { atomname: &apos;OP2&apos; },
                                        { atomname: &quot;O3&apos;&quot; },
                                        { atomname: &apos;O3*&apos; },
                                        { atomname: &quot;O5&apos;&quot; },
                                        { atomname: &apos;O5*&apos; },
                                        { atomname: &quot;C5&apos;&quot; },
                                        { atomname: &apos;C5*&apos; }
                  ]
                }
              ]
            }
          ]
        })
        continue
      }

      if (cu === &apos;LIGAND&apos;) {
        pushRule({
          operator: &apos;AND&apos;,
          rules: [
            {
              operator: &apos;OR&apos;,
              rules: [
                                { keyword: kwd.HETERO },
                {
                  negate: true,
                  operator: undefined,
                  rules: [
                                        { keyword: kwd.POLYMER }
                  ]
                }
              ]
            },
            {
              negate: true,
              operator: undefined,
              rules: [
                {
                  operator: &apos;OR&apos;,
                  rules: [
                                        { keyword: kwd.WATER },
                                        { keyword: kwd.ION }
                  ]
                }
              ]
            }
          ]
        })
        continue
      }

      if (SelectAllKeyword.indexOf(cu) !== -1) {
        pushRule({ keyword: kwd.ALL })
        continue
      }

            // handle atom expressions

      if (c.charAt(0) === &apos;@&apos;) {
        const indexList = c.substr(1).split(&apos;,&apos;)
        for (let k = 0, kl = indexList.length; k &lt; kl; ++k) {
          indexList[ k ] = parseInt(indexList[ k ])
        }
        indexList.sort(function (a, b) { return a - b })
        pushRule({ atomindex: indexList })
        continue
      }

      if (c.charAt(0) === &apos;#&apos;) {
        console.error(&apos;# for element selection deprecated, use _&apos;)
        pushRule({ element: cu.substr(1) })
        continue
      }
      if (c.charAt(0) === &apos;_&apos;) {
        pushRule({ element: cu.substr(1) })
        continue
      }

      if (c[0] === &apos;[&apos; &amp;&amp; c[c.length - 1] === &apos;]&apos;) {
        const resnameList = cu.substr(1, c.length - 2).split(&apos;,&apos;)
        const resname = resnameList.length &gt; 1 ? resnameList : resnameList[ 0 ]
        pushRule({ resname: resname })
        continue
      } else if (
                (c.length &gt;= 1 &amp;&amp; c.length &lt;= 4) &amp;&amp;
                c[0] !== &apos;^&apos; &amp;&amp; c[0] !== &apos;:&apos; &amp;&amp; c[0] !== &apos;.&apos; &amp;&amp; c[0] !== &apos;%&apos; &amp;&amp; c[0] !== &apos;/&apos; &amp;&amp;
                isNaN(parseInt(c))
            ) {
        pushRule({ resname: cu })
        continue
      }

            // there must be only one constraint per rule
            // otherwise a test quickly becomes not applicable
            // e.g. chainTest for chainname when resno is present too

      const sele = {
        operator: &apos;AND&apos;,
        rules: []
      }

      const model = c.split(&apos;/&apos;)
      if (model.length &gt; 1 &amp;&amp; model[1]) {
        if (isNaN(parseInt(model[1]))) {
          throw new Error(&apos;model must be an integer&apos;)
        }
        sele.rules.push({
          model: parseInt(model[1])
        })
      }

      const altloc = model[0].split(&apos;%&apos;)
      if (altloc.length &gt; 1) {
        sele.rules.push({
          altloc: altloc[1]
        })
      }

      const atomname = altloc[0].split(&apos;.&apos;)
      if (atomname.length &gt; 1 &amp;&amp; atomname[1]) {
        if (atomname[1].length &gt; 4) {
          throw new Error(&apos;atomname must be one to four characters&apos;)
        }
        sele.rules.push({
          atomname: atomname[1].substring(0, 4).toUpperCase()
        })
      }

      const chain = atomname[0].split(&apos;:&apos;)
      if (chain.length &gt; 1 &amp;&amp; chain[1]) {
        sele.rules.push({
          chainname: chain[1]
        })
      }

      const inscode = chain[0].split(&apos;^&apos;)
      if (inscode.length &gt; 1) {
        sele.rules.push({
          inscode: inscode[1]
        })
      }

      if (inscode[0]) {
        let negate, negate2
        if (inscode[0][0] === &apos;-&apos;) {
          inscode[0] = inscode[0].substr(1)
          negate = true
        }
        if (inscode[0].includes(&apos;--&apos;)) {
          inscode[0] = inscode[0].replace(&apos;--&apos;, &apos;-&apos;)
          negate2 = true
        }
        let resi = inscode[0].split(&apos;-&apos;)
        if (resi.length === 1) {
          resi = parseInt(resi[0])
          if (isNaN(resi)) {
            throw new Error(&apos;resi must be an integer&apos;)
          }
          if (negate) resi *= -1
          sele.rules.push({
            resno: resi
          })
        } else if (resi.length === 2) {
          if (negate) resi[0] *= -1
          if (negate2) resi[1] *= -1
          sele.rules.push({
            resno: [ parseInt(resi[0]), parseInt(resi[1]) ]
          })
        } else {
          throw new Error(&quot;resi range must contain one &apos;-&apos;&quot;)
        }
      }

            // round up

      if (sele.rules.length === 1) {
        pushRule(sele.rules[ 0 ])
      } else if (sele.rules.length &gt; 1) {
        pushRule(sele)
      } else {
        throw new Error(&apos;empty selection chunk&apos;)
      }
    }

        // cleanup

    if (
            this.selection.operator === undefined &amp;&amp;
            this.selection.rules.length === 1 &amp;&amp;
            this.selection.rules[ 0 ].hasOwnProperty(&apos;operator&apos;)
        ) {
      this.selection = this.selection.rules[ 0 ]
    }
  }

  _makeTest (fn, selection) {
    if (selection === undefined) selection = this.selection
    if (selection === null) return false
    if (selection.error) return false

    const n = selection.rules.length
    if (n === 0) return false

    const t = !selection.negate
    const f = !!selection.negate

    const subTests = []
    for (let i = 0; i &lt; n; ++i) {
      const s = selection.rules[ i ]
      if (s.hasOwnProperty(&apos;operator&apos;)) {
        subTests[ i ] = this._makeTest(fn, s)
      }
    }

        // ( x and y ) can short circuit on false
        // ( x or y ) can short circuit on true
        // not ( x and y )

    return function test (entity) {
      const and = selection.operator === &apos;AND&apos;
      let na = false

      for (let i = 0; i &lt; n; ++i) {
        const s = selection.rules[ i ]
        let ret

        if (s.hasOwnProperty(&apos;operator&apos;)) {
          if (subTests[ i ]) {
            ret = subTests[ i ](entity)
          } else {
            ret = -1
          }

          if (ret === -1) {
            na = true
            continue
          } else if (ret === true) {
            if (and) { continue } else { return t }
          } else {
            if (and) { return f } else { continue }
          }
        } else {
          if (s.keyword === kwd.ALL) {
            if (and) { continue } else { return t }
          }

          ret = fn(entity, s)

                    // console.log( entity.qualifiedName(), ret, s, selection.negate, &quot;t&quot;, t, &quot;f&quot;, f )

          if (ret === -1) {
            na = true
            continue
          } else if (ret === true) {
            if (and) { continue } else { return t }
          } else {
            if (and) { return f } else { continue }
          }
        }
      }

      if (na) {
        return -1
      } else {
        if (and) { return t } else { return f }
      }
    }
  }

  _filter (fn, selection) {
    if (selection === undefined) selection = this.selection
    if (selection.error) return selection

    const n = selection.rules.length
    if (n === 0) return selection

    const filtered = {
      operator: selection.operator,
      rules: []
    }
    if (selection.hasOwnProperty(&apos;negate&apos;)) {
      filtered.negate = selection.negate
    }

    for (let i = 0; i &lt; n; ++i) {
      const s = selection.rules[ i ]
      if (s.hasOwnProperty(&apos;operator&apos;)) {
        const fs = this._filter(fn, s)
        if (fs !== null) filtered.rules.push(fs)
      } else if (!fn(s)) {
        filtered.rules.push(s)
      }
    }

    if (filtered.rules.length &gt; 0) {
            // TODO maybe the filtered rules could be returned
            // in some case, but the way how tests are applied
            // e.g. when traversing a structure would also need
            // to change
      return selection
            // return filtered;
    } else {
      return null
    }
  }

  makeAtomTest (atomOnly) {
    let selection

    if (atomOnly) {
            // console.log( this.selection )

      selection = this._filter(function (s) {
        if (s.keyword !== undefined &amp;&amp; !AtomOnlyKeywords.includes(s.keyword)) return true
        if (s.model !== undefined) return true
        if (s.chainname !== undefined) return true
        if (s.resname !== undefined) return true
        if (s.resno !== undefined) return true
        if (s.sstruc !== undefined) return true
        return false
      })
    } else {
      selection = this.selection
    }

    return this._makeTest(atomTestFn, selection)
  }

  makeResidueTest (residueOnly) {
    let selection

    if (residueOnly) {
            // console.log( this.selection )

      selection = this._filter(function (s) {
        if (s.keyword !== undefined &amp;&amp; AtomOnlyKeywords.includes(s.keyword)) return true
        if (s.model !== undefined) return true
        if (s.chainname !== undefined) return true
        if (s.atomname !== undefined) return true
        if (s.element !== undefined) return true
        if (s.altloc !== undefined) return true
        return false
      })
    } else {
      selection = this.selection
    }

    return this._makeTest(residueTestFn, selection)
  }

  makeChainTest (chainOnly) {
    let selection

    if (chainOnly) {
            // console.log( this.selection )

      selection = this._filter(function (s) {
        if (s.keyword !== undefined &amp;&amp; !ChainKeywords.includes(s.keyword)) return true
                // if( s.model!==undefined ) return true;
        if (s.resname !== undefined) return true
        if (s.resno !== undefined) return true
        if (s.atomname !== undefined) return true
        if (s.element !== undefined) return true
        if (s.altloc !== undefined) return true
        if (s.sstruc !== undefined) return true
        if (s.inscode !== undefined) return true
        return false
      })
    } else {
      selection = this.selection
    }

    return this._makeTest(chainTestFn, selection)
  }

  makeModelTest (modelOnly) {
    let selection

    if (modelOnly) {
            // console.log( this.selection )

      selection = this._filter(function (s) {
        if (s.keyword !== undefined) return true
        if (s.chainname !== undefined) return true
        if (s.resname !== undefined) return true
        if (s.resno !== undefined) return true
        if (s.atomname !== undefined) return true
        if (s.element !== undefined) return true
        if (s.altloc !== undefined) return true
        if (s.sstruc !== undefined) return true
        if (s.inscode !== undefined) return true
        return false
      })
    } else {
      selection = this.selection
    }

    return this._makeTest(modelTestFn, selection)
  }
}

export default Selection

export {
    kwd
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-69549173-1', 'auto');
    ga('send', 'pageview');
</script></body>
</html>

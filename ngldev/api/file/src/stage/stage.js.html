<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/stage/stage.js | NGL Viewer API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header><span>NGL@0.10.4-1</span>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a href="./../gallery/index.html">Gallery</a><a data-ice="repoURL" href="https://github.com/arose/ngl.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/script.js~Script.html">Script</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/selection.js~Selection.html">Selection</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-binarySearchIndexOf">binarySearchIndexOf</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Browser">Browser</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ColormakerRegistry">ColormakerRegistry</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ExtensionFragDepth">ExtensionFragDepth</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Mobile">Mobile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Version">Version</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Box3">Box3</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/core/BufferGeometry">BufferGeometry</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">Char</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Color">Color</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Euler">Euler</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">Float</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">Integer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Matrix3">Matrix3</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Matrix4">Matrix4</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Plane">Plane</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Quaternion">Quaternion</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://millermedeiros.github.io/js-signals/docs/symbols/Signal.html">Signal</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray">TypedArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Vector2">Vector2</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://threejs.org/docs/#api/math/Vector3">Vector3</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">align</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-superpose">superpose</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">animation</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~AnimationList.html">AnimationList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~MoveAnimation.html">MoveAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~RockAnimation.html">RockAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~RotateAnimation.html">RotateAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~SpinAnimation.html">SpinAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~TimeoutAnimation.html">TimeoutAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~ValueAnimation.html">ValueAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation/animation.js~ZoomAnimation.html">ZoomAnimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/animation/animation.js~Animation.html">Animation</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">buffer</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/arrow-buffer.js~ArrowBuffer.html">ArrowBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/cone-buffer.js~ConeBuffer.html">ConeBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/conegeometry-buffer.js~ConeGeometryBuffer.html">ConeGeometryBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/contour-buffer.js~ContourBuffer.html">ContourBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/cylinder-buffer.js~CylinderBuffer.html">CylinderBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/cylindergeometry-buffer.js~CylinderGeometryBuffer.html">CylinderGeometryBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/cylinderimpostor-buffer.js~CylinderImpostorBuffer.html">CylinderImpostorBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/doublesided-buffer.js~DoubleSidedBuffer.html">DoubleSidedBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/ellipsoid-buffer.js~EllipsoidBuffer.html">EllipsoidBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/ellipsoidgeometry-buffer.js~EllipsoidGeometryBuffer.html">EllipsoidGeometryBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/hyperballstick-buffer.js~HyperballStickBuffer.html">HyperballStickBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/hyperballstickimpostor-buffer.js~HyperballStickImpostorBuffer.html">HyperballStickImpostorBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/image-buffer.js~ImageBuffer.html">ImageBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/line-buffer.js~LineBuffer.html">LineBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/mesh-buffer.js~MeshBuffer.html">MeshBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/point-buffer.js~PointBuffer.html">PointBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/ribbon-buffer.js~RibbonBuffer.html">RibbonBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/sphere-buffer.js~SphereBuffer.html">SphereBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/spheregeometry-buffer.js~SphereGeometryBuffer.html">SphereGeometryBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/sphereimpostor-buffer.js~SphereImpostorBuffer.html">SphereImpostorBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/surface-buffer.js~SurfaceBuffer.html">SurfaceBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/text-buffer.js~TextBuffer.html">TextBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/trace-buffer.js~TraceBuffer.html">TraceBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/tubemesh-buffer.js~TubeMeshBuffer.html">TubeMeshBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/buffer/vector-buffer.js~VectorBuffer.html">VectorBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/alignedbox-buffer.js~AlignedBoxBuffer.html">AlignedBoxBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/box-buffer.js~BoxBuffer.html">BoxBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/buffer.js~Buffer.html">Buffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/geometry-buffer.js~GeometryBuffer.html">GeometryBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/mapped-buffer.js~MappedBuffer.html">MappedBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/buffer/quad-buffer.js~QuadBuffer.html">QuadBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-BufferParameters">BufferParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TextBufferParameters">TextBufferParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">color</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/atomindex-colormaker.js~AtomindexColormaker.html">AtomindexColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/bfactor-colormaker.js~BfactorColormaker.html">BfactorColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/chainid-colormaker.js~ChainidColormaker.html">ChainidColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/chainindex-colormaker.js~ChainindexColormaker.html">ChainindexColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/chainname-colormaker.js~ChainnameColormaker.html">ChainnameColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/colormaker-registry.js~ColormakerRegistry.html">ColormakerRegistry</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/densityfit-colormaker.js~DensityfitColormaker.html">DensityfitColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/electrostatic-colormaker.js~ElectrostaticColormaker.html">ElectrostaticColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/element-colormaker.js~ElementColormaker.html">ElementColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/entityindex-colormaker.js~EntityindexColormaker.html">EntityindexColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/entitytype-colormaker.js~EntitytypeColormaker.html">EntitytypeColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/geoquality-colormaker.js~GeoqualityColormaker.html">GeoqualityColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/hydrophobicity-colormaker.js~HydrophobicityColormaker.html">HydrophobicityColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/modelindex-colormaker.js~ModelindexColormaker.html">ModelindexColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/moleculetype-colormaker.js~MoleculetypeColormaker.html">MoleculetypeColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/occupancy-colormaker.js~OccupancyColormaker.html">OccupancyColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/random-colormaker.js~RandomColormaker.html">RandomColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/residueindex-colormaker.js~ResidueindexColormaker.html">ResidueindexColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/resname-colormaker.js~ResnameColormaker.html">ResnameColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/selection-colormaker.js~SelectionColormaker.html">SelectionColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/sstruc-colormaker.js~SstrucColormaker.html">SstrucColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/uniform-colormaker.js~UniformColormaker.html">UniformColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/value-colormaker.js~ValueColormaker.html">ValueColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/color/volume-colormaker.js~VolumeColormaker.html">VolumeColormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/color/colormaker.js~Colormaker.html">Colormaker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-ColormakerParameters">ColormakerParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">component</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/annotation.js~Annotation.html">Annotation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/representation-component.js~RepresentationComponent.html">RepresentationComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/script-component.js~ScriptComponent.html">ScriptComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/shape-component.js~ShapeComponent.html">ShapeComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/structure-component.js~StructureComponent.html">StructureComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/surface-component.js~SurfaceComponent.html">SurfaceComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/trajectory-component.js~TrajectoryComponent.html">TrajectoryComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/component/volume-component.js~VolumeComponent.html">VolumeComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/component/component.js~Component.html">Component</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-ComponentParameters">ComponentParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-ComponentSignals">ComponentSignals</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-RepresentationComponentSignals">RepresentationComponentSignals</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StructureComponentSignals">StructureComponentSignals</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TrajectoryComponentParameters">TrajectoryComponentParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TrajectoryComponentSignals">TrajectoryComponentSignals</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">controls</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/animation-controls.js~AnimationControls.html">AnimationControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/component-controls.js~ComponentControls.html">ComponentControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/mouse-actions.js~MouseActions.html">MouseActions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/mouse-controls.js~MouseControls.html">MouseControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/picking-controls.js~PickingControls.html">PickingControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/picking-proxy.js~PickingProxy.html">PickingProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/trackball-controls.js~TrackballControls.html">TrackballControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controls/viewer-controls.js~ViewerControls.html">ViewerControls</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TriggerString">TriggerString</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-PickingData">PickingData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-OrientationMatrix">OrientationMatrix</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">geometry</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/geometry/shape.js~Shape.html">Shape</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">loader</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/loader/loader.js~Loader.html">Loader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/loader/parser-loader.js~ParserLoader.html">ParserLoader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/loader/plugin-loader.js~PluginLoader.html">PluginLoader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/loader/script-loader.js~ScriptLoader.html">ScriptLoader</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-autoLoad">autoLoad</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-LoaderParameters">LoaderParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">math</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/math/principal-axes.js~PrincipalAxes.html">PrincipalAxes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-quicksortIP">quicksortIP</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-lineLineIntersect">lineLineIntersect</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">parser</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/parser/csv-parser.js~CsvParser.html">CsvParser</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">proxy</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/atom-proxy.js~AtomProxy.html">AtomProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/bond-proxy.js~BondProxy.html">BondProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/chain-proxy.js~ChainProxy.html">ChainProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/model-proxy.js~ModelProxy.html">ModelProxy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/polymer.js~Polymer.html">Polymer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/proxy/residue-proxy.js~ResidueProxy.html">ResidueProxy</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">representation</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/axes-representation.js~AxesRepresentation.html">AxesRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/backbone-representation.js~BackboneRepresentation.html">BackboneRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/ballandstick-representation.js~BallAndStickRepresentation.html">BallAndStickRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/base-representation.js~BaseRepresentation.html">BaseRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/buffer-representation.js~BufferRepresentation.html">BufferRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/cartoon-representation.js~CartoonRepresentation.html">CartoonRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/distance-representation.js~DistanceRepresentation.html">DistanceRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/label-representation.js~LabelRepresentation.html">LabelRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/licorice-representation.js~LicoriceRepresentation.html">LicoriceRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/line-representation.js~LineRepresentation.html">LineRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/representation.js~Representation.html">Representation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/structure-representation.js~StructureRepresentation.html">StructureRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/surface-representation.js~SurfaceRepresentation.html">SurfaceRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/trajectory-representation.js~TrajectoryRepresentation.html">TrajectoryRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/representation/validation-representation.js~ValidationRepresentation.html">ValidationRepresentation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-BallAndStickRepresentationParameters">BallAndStickRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-DistanceRepresentationParameters">DistanceRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-LabelRepresentationParameters">LabelRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-RepresentationParameters">RepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StructureRepresentationParameters">StructureRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-SurfaceRepresentationParameters">SurfaceRepresentationParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TrajectoryRepresentationParameters">TrajectoryRepresentationParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">stage</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/stage/mouse-observer.js~MouseObserver.html">MouseObserver</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/stage/stage.js~Stage.html">Stage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-MouseSignals">MouseSignals</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StageParameters">StageParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StageSignals">StageSignals</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">store</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/atom-store.js~AtomStore.html">AtomStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/atom-type.js~AtomType.html">AtomType</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/bond-store.js~BondStore.html">BondStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/chain-store.js~ChainStore.html">ChainStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/model-store.js~ModelStore.html">ModelStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/residue-store.js~ResidueStore.html">ResidueStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/residue-type.js~ResidueType.html">ResidueType</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/store/store.js~Store.html">Store</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">structure</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/structure/entity.js~Entity.html">Entity</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/structure/structure-view.js~StructureView.html">StructureView</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/structure/structure.js~Structure.html">Structure</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-assignResidueTypeBonds">assignResidueTypeBonds</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StructureExtraData">StructureExtraData</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StructureHeader">StructureHeader</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">surface</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/surface/molecular-surface.js~MolecularSurface.html">MolecularSurface</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/surface/surface.js~Surface.html">Surface</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/surface/volume.js~Volume.html">Volume</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-AVHash">AVHash</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-MolecularSurfaceParameters">MolecularSurfaceParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">symmetry</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/symmetry/assembly.js~Assembly.html">Assembly</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/symmetry/unitcell.js~Unitcell.html">Unitcell</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">trajectory</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/trajectory/trajectory-player.js~TrajectoryPlayer.html">TrajectoryPlayer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/trajectory/trajectory.js~Trajectory.html">Trajectory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TrajectoryPlayerParameters">TrajectoryPlayerParameters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-TrajectoryParameters">TrajectoryParameters</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">utils</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/bitarray.js~BitArray.html">BitArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/counter.js~Counter.html">Counter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/utils/picker.js~Picker.html">Picker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-interface">I</span><span data-ice="name"><span><a href="class/src/utils/picker.js~ShapePicker.html">ShapePicker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-BinaryHeap">BinaryHeap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Kdtree">Kdtree</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">viewer</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-makeImage">makeImage</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Viewer">Viewer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-ImageParameters">ImageParameters</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/stage/stage.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/**
 * @file Stage
 * @author Alexander Rose &lt;alexander.rose@weirdbyte.de&gt;
 * @private
 */


import { Vector3 } from &quot;../../lib/three.es6.js&quot;;
import Signal from &quot;../../lib/signals.es6.js&quot;;

import { Debug, Log, Mobile, ComponentRegistry } from &quot;../globals.js&quot;;
import { defaults, getFileInfo } from &quot;../utils.js&quot;;
import { degToRad, clamp, pclamp } from &quot;../math/math-utils.js&quot;;
import Counter from &quot;../utils/counter.js&quot;;
import Viewer from &quot;../viewer/viewer.js&quot;;
import MouseObserver from &quot;./mouse-observer.js&quot;;

import TrackballControls from &quot;../controls/trackball-controls.js&quot;;
import PickingControls from &quot;../controls/picking-controls.js&quot;;
import ViewerControls from &quot;../controls/viewer-controls.js&quot;;
import AnimationControls from &quot;../controls/animation-controls.js&quot;;
import MouseControls from &quot;../controls/mouse-controls.js&quot;;

import PickingBehavior from &quot;./picking-behavior.js&quot;;
import MouseBehavior from &quot;./mouse-behavior.js&quot;;
import AnimationBehavior from &quot;./animation-behavior.js&quot;;
import KeyBehavior from &quot;./key-behavior.js&quot;;

import Component from &quot;../component/component.js&quot;;
// eslint-disable-next-line no-unused-vars
import RepresentationComponent from &quot;../component/representation-component.js&quot;;
import Collection from &quot;../component/collection.js&quot;;
import ComponentCollection from &quot;../component/component-collection.js&quot;;
import RepresentationCollection from &quot;../component/representation-collection.js&quot;;
import { autoLoad } from &quot;../loader/loader-utils&quot;;


function matchName( name, comp ){
    if( name instanceof RegExp ){
        return comp.name.match( name ) !== null;
    }else{
        return comp.name === name;
    }
}

const tmpZoomVector = new Vector3();


/**
 * Stage parameter object.
 * @typedef {Object} StageParameters - stage parameters
 * @property {Color} backgroundColor - background color
 * @property {Integer} sampleLevel - sampling level for antialiasing, between -1 and 5;
 *                                   -1: no sampling, 0: only sampling when not moving
 * @property {Boolean} workerDefault - default value for useWorker parameter of representations
 * @property {Float} rotateSpeed - camera-controls rotation speed, between 0 and 10
 * @property {Float} zoomSpeed - camera-controls zoom speed, between 0 and 10
 * @property {Float} panSpeed - camera-controls pan speed, between 0 and 10
 * @property {Integer} clipNear - position of camera near/front clipping plane
 *                                in percent of scene bounding box
 * @property {Integer} clipFar - position of camera far/back clipping plane
 *                               in percent of scene bounding box
 * @property {Float} clipDist - camera clipping distance in Angstrom
 * @property {Integer} fogNear - position of the start of the fog effect
 *                               in percent of scene bounding box
 * @property {Integer} fogFar - position where the fog is in full effect
 *                              in percent of scene bounding box
 * @property {String} cameraType - type of camera, either &apos;persepective&apos; or &apos;orthographic&apos;
 * @property {Float} cameraFov - camera field of view in degree, between 15 and 120
 * @property {Color} lightColor - point light color
 * @property {Float} lightIntensity - point light intensity
 * @property {Color} ambientColor - ambient light color
 * @property {Float} ambientIntensity - ambient light intensity
 * @property {Integer} hoverTimeout - timeout for hovering
 */


/**
 * @example
 * stage.signals.componentAdded.add( function( component ){ ... } );
 *
 * @typedef {Object} StageSignals
 * @property {Signal&lt;StageParameters&gt;} parametersChanged - on parameters change
 * @property {Signal&lt;Boolean&gt;} fullscreenChanged - on fullscreen change
 * @property {Signal&lt;Component&gt;} componentAdded - when a component is added
 * @property {Signal&lt;Component&gt;} componentRemoved - when a component is removed
 * @property {Signal&lt;PickingProxy|undefined&gt;} clicked - on click
 * @property {Signal&lt;PickingProxy|undefined&gt;} hovered - on hover
 */


/**
 * Stage class, central for creating molecular scenes with NGL.
 *
 * @example
 * var stage = new Stage( &quot;elementId&quot;, { backgroundColor: &quot;white&quot; } );
 */
class Stage{

    /**
     * Create a Stage instance
     * @param {String|Element} [idOrElement] - dom id or element
     * @param {StageParameters} params - parameters object
     */
    constructor( idOrElement, params ){

        /**
         * Events emitted by the stage
         * @type {StageSignals}
         */
        this.signals = {
            parametersChanged: new Signal(),
            fullscreenChanged: new Signal(),

            componentAdded: new Signal(),
            componentRemoved: new Signal(),

            clicked: new Signal(),
            hovered: new Signal()
        };

        //

        /**
         * Counter that keeps track of various potentially long-running tasks,
         * including file loading and surface calculation.
         * @type {Counter}
         */
        this.tasks = new Counter();
        this.compList = [];
        this.defaultFileParams = {};

        //

        this.viewer = new Viewer( idOrElement );
        if( !this.viewer.renderer ) return;

        /**
         * Tooltip element
         * @type {Element}
         */
        this.tooltip = document.createElement( &quot;div&quot; );
        Object.assign( this.tooltip.style, {
            display: &quot;none&quot;,
            position: &quot;fixed&quot;,
            zIndex: 2 + ( parseInt( this.viewer.container.style.zIndex ) || 0 ),
            pointerEvents: &quot;none&quot;,
            backgroundColor: &quot;rgba( 0, 0, 0, 0.6 )&quot;,
            color: &quot;lightgrey&quot;,
            padding: &quot;8px&quot;,
            fontFamily: &quot;sans-serif&quot;
        } );
        document.body.appendChild( this.tooltip );

        /**
         * @type {MouseObserver}
         */
        this.mouseObserver = new MouseObserver( this.viewer.renderer.domElement );

        /**
         * @type {ViewerControls}
         */
        this.viewerControls = new ViewerControls( this );
        this.trackballControls = new TrackballControls( this );
        this.pickingControls = new PickingControls( this );
        /**
         * @type {AnimationControls}
         */
        this.animationControls = new AnimationControls( this );
        /**
         * @type {MouseControls}
         */
        this.mouseControls = new MouseControls( this );

        this.pickingBehavior = new PickingBehavior( this );
        this.mouseBehavior = new MouseBehavior( this );
        this.animationBehavior = new AnimationBehavior( this );
        this.keyBehavior = new KeyBehavior( this );

        /**
         * @type {SpinAnimation}
         */
        this.spinAnimation = this.animationControls.spin( [ 0, 1, 0 ], 0.005 );
        this.spinAnimation.pause( true );
        /**
         * @type {RockAnimation}
         */
        this.rockAnimation = this.animationControls.rock( [ 0, 1, 0 ], 0.005 );
        this.rockAnimation.pause( true );

        const p = Object.assign( {
            impostor: true,
            quality: &quot;medium&quot;,
            workerDefault: true,
            sampleLevel: 0,
            backgroundColor: &quot;black&quot;,
            rotateSpeed: 2.0,
            zoomSpeed: 1.2,
            panSpeed: 1.0,
            clipNear: 0,
            clipFar: 100,
            clipDist: 10,
            fogNear: 50,
            fogFar: 100,
            cameraFov: 40,
            cameraType: &quot;perspective&quot;,
            lightColor: 0xdddddd,
            lightIntensity: 1.0,
            ambientColor: 0xdddddd,
            ambientIntensity: 0.2,
            hoverTimeout: 0,
            tooltip: true,
            mousePreset: &quot;default&quot;
        }, params );

        this.parameters = {
            backgroundColor: {
                type: &quot;color&quot;
            },
            quality: {
                type: &quot;select&quot;, options: { auto: &quot;auto&quot;, low: &quot;low&quot;, medium: &quot;medium&quot;, high: &quot;high&quot; }
            },
            sampleLevel: {
                type: &quot;range&quot;, step: 1, max: 5, min: -1
            },
            impostor: {
                type: &quot;boolean&quot;
            },
            workerDefault: {
                type: &quot;boolean&quot;
            },
            rotateSpeed: {
                type: &quot;number&quot;, precision: 1, max: 10, min: 0
            },
            zoomSpeed: {
                type: &quot;number&quot;, precision: 1, max: 10, min: 0
            },
            panSpeed: {
                type: &quot;number&quot;, precision: 1, max: 10, min: 0
            },
            clipNear: {
                type: &quot;range&quot;, step: 1, max: 100, min: 0
            },
            clipFar: {
                type: &quot;range&quot;, step: 1, max: 100, min: 0
            },
            clipDist: {
                type: &quot;integer&quot;, max: 200, min: 0
            },
            fogNear: {
                type: &quot;range&quot;, step: 1, max: 100, min: 0
            },
            fogFar: {
                type: &quot;range&quot;, step: 1, max: 100, min: 0
            },
            cameraType: {
                type: &quot;select&quot;, options: { perspective: &quot;perspective&quot;, orthographic: &quot;orthographic&quot; }
            },
            cameraFov: {
                type: &quot;range&quot;, step: 1, max: 120, min: 15
            },
            lightColor: {
                type: &quot;color&quot;
            },
            lightIntensity: {
                type: &quot;number&quot;, precision: 2, max: 10, min: 0
            },
            ambientColor: {
                type: &quot;color&quot;
            },
            ambientIntensity: {
                type: &quot;number&quot;, precision: 2, max: 10, min: 0
            },
            hoverTimeout: {
                type: &quot;integer&quot;, max: 10000, min: -1
            },
            tooltip: {
                type: &quot;boolean&quot;
            },
            mousePreset: {
                type: &quot;select&quot;, options: { default: &quot;default&quot;, pymol: &quot;pymol&quot;, coot: &quot;coot&quot; }
            }
        };

        this.setParameters( p );  // must come after the viewer has been instantiated

        this.viewer.animate();

    }

    /**
     * Set stage parameters
     * @param {StageParameters} params - stage parameters
     * @return {Stage} this object
     */
    setParameters( params ){

        const p = Object.assign( {}, params );
        const tp = this.parameters;
        const viewer = this.viewer;
        const controls = this.trackballControls;

        for( let name in p ){

            if( p[ name ] === undefined ) continue;
            if( !tp[ name ] ) continue;

            if( tp[ name ].int ) p[ name ] = parseInt( p[ name ] );
            if( tp[ name ].float ) p[ name ] = parseFloat( p[ name ] );

            tp[ name ].value = p[ name ];

        }

        // apply parameters
        if( p.quality !== undefined ) this.setQuality( p.quality );
        if( p.impostor !== undefined ) this.setImpostor( p.impostor );
        if( p.rotateSpeed !== undefined ) controls.rotateSpeed = p.rotateSpeed;
        if( p.zoomSpeed !== undefined ) controls.zoomSpeed = p.zoomSpeed;
        if( p.panSpeed !== undefined ) controls.panSpeed = p.panSpeed;
        if( p.mousePreset !== undefined ) this.mouseControls.preset( p.mousePreset );
        this.mouseObserver.setParameters( { hoverTimeout: p.hoverTimeout } );
        viewer.setClip( p.clipNear, p.clipFar, p.clipDist );
        viewer.setFog( undefined, p.fogNear, p.fogFar );
        viewer.setCamera( p.cameraType, p.cameraFov );
        viewer.setSampling( p.sampleLevel );
        viewer.setBackground( p.backgroundColor );
        viewer.setLight(
            p.lightColor, p.lightIntensity, p.ambientColor, p.ambientIntensity
        );

        this.signals.parametersChanged.dispatch(
            this.getParameters()
        );

        return this;

    }

    /**
     * Get stage parameters
     * @return {StageParameters} parameter object
     */
    getParameters(){

        const params = {};
        for( let name in this.parameters ){
            params[ name ] = this.parameters[ name ].value;
        }
        return params;

    }

    /**
     * Create default representations for the given component
     * @param  {StructureComponent|SurfaceComponent} object - component to create the representations for
     * @return {undefined}
     */
    defaultFileRepresentation( object ){

        if( object.type === &quot;structure&quot; ){

            object.setSelection( &quot;/0&quot; );

            let atomCount, residueCount, instanceCount;
            const structure = object.structure;

            if( structure.biomolDict.BU1 ){
                const assembly = structure.biomolDict.BU1;
                atomCount = assembly.getAtomCount( structure );
                residueCount = assembly.getResidueCount( structure );
                instanceCount = assembly.getInstanceCount();
                object.setDefaultAssembly( &quot;BU1&quot; );
            }else{
                atomCount = structure.getModelProxy( 0 ).atomCount;
                residueCount = structure.getModelProxy( 0 ).residueCount;
                instanceCount = 1;
            }

            let sizeScore = atomCount;

            if( Mobile ){
                sizeScore *= 4;
            }

            const backboneOnly = structure.atomStore.count / structure.residueStore.count &lt; 2;
            if( backboneOnly ){
                sizeScore *= 10;
            }

            let colorScheme = &quot;chainname&quot;;
            let colorScale = &quot;RdYlBu&quot;;
            let colorReverse = false;
            if( structure.getChainnameCount( &quot;polymer and /0&quot; ) === 1 ){
                colorScheme = &quot;residueindex&quot;;
                colorScale = &quot;spectral&quot;;
                colorReverse = true;
            }

            if( Debug ) console.log( sizeScore, atomCount, instanceCount, backboneOnly );

            if( residueCount / instanceCount &lt; 4 ){

                object.addRepresentation( &quot;ball+stick&quot;, {
                    colorScheme: &quot;element&quot;,
                    scale: 2.0,
                    aspectRatio: 1.5,
                    bondScale: 0.3,
                    bondSpacing: 0.75,
                    quality: &quot;auto&quot;
                } );

            }else if(
                ( instanceCount &gt; 5 &amp;&amp; sizeScore &gt; 15000 ) ||
                sizeScore &gt; 700000
            ){

                let scaleFactor = (
                    Math.min(
                        1.5,
                        Math.max(
                            0.1,
                            2000 / ( sizeScore / instanceCount )
                        )
                    )
                );
                if( backboneOnly ) scaleFactor = Math.min( scaleFactor, 0.15 );

                object.addRepresentation( &quot;surface&quot;, {
                    sele: &quot;polymer&quot;,
                    surfaceType: &quot;sas&quot;,
                    probeRadius: 1.4,
                    scaleFactor: scaleFactor,
                    colorScheme: colorScheme,
                    colorScale: colorScale,
                    colorReverse: colorReverse,
                    useWorker: false
                } );

            }else if( sizeScore &gt; 250000 ){

                object.addRepresentation( &quot;backbone&quot;, {
                    lineOnly: true,
                    colorScheme: colorScheme,
                    colorScale: colorScale,
                    colorReverse: colorReverse
                } );

            }else if( sizeScore &gt; 100000 ){

                object.addRepresentation( &quot;backbone&quot;, {
                    quality: &quot;low&quot;,
                    disableImpostor: true,
                    colorScheme: colorScheme,
                    colorScale: colorScale,
                    colorReverse: colorReverse,
                    scale: 2.0
                } );

            }else if( sizeScore &gt; 80000 ){

                object.addRepresentation( &quot;backbone&quot;, {
                    colorScheme: colorScheme,
                    colorScale: colorScale,
                    colorReverse: colorReverse,
                    scale: 2.0
                } );

            }else{

                object.addRepresentation( &quot;cartoon&quot;, {
                    colorScheme: colorScheme,
                    colorScale: colorScale,
                    colorReverse: colorReverse,
                    scale: 0.7,
                    aspectRatio: 5,
                    quality: &quot;auto&quot;
                } );
                if( sizeScore &lt; 50000 ){
                    object.addRepresentation( &quot;base&quot;, {
                        colorScheme: colorScheme,
                        colorScale: colorScale,
                        colorReverse: colorReverse,
                        quality: &quot;auto&quot;
                    } );
                }
                object.addRepresentation( &quot;ball+stick&quot;, {
                    sele: &quot;ligand&quot;,
                    colorScheme: &quot;element&quot;,
                    scale: 2.0,
                    aspectRatio: 1.5,
                    bondScale: 0.3,
                    bondSpacing: 0.75,
                    quality: &quot;auto&quot;
                } );

            }

            // add frames as trajectory
            if( object.structure.frames.length ) object.addTrajectory();

        }else if( object.type === &quot;surface&quot; || object.type === &quot;volume&quot; ){

            object.addRepresentation( &quot;surface&quot; );

        }

        this.tasks.onZeroOnce( this.autoView, this );

    }

    /**
     * Load a file onto the stage
     *
     * @example
     * // load from URL
     * stage.loadFile( &quot;http://files.rcsb.org/download/5IOS.cif&quot; );
     *
     * @example
     * // load binary data in CCP4 format via a Blob
     * var binaryBlob = new Blob( [ ccp4Data ], { type: &apos;application/octet-binary&apos;} );
     * stage.loadFile( binaryBlob, { ext: &quot;ccp4&quot; } );
     *
     * @example
     * // load string data in PDB format via a Blob
     * var stringBlob = new Blob( [ pdbData ], { type: &apos;text/plain&apos;} );
     * stage.loadFile( stringBlob, { ext: &quot;pdb&quot; } );
     *
     * @example
     * // load a File object
     * stage.loadFile( file );
     *
     * @example
     * // load from URL and add a &apos;ball+stick&apos; representation with double/triple bonds
     * stage.loadFile( &quot;http://files.rcsb.org/download/1crn.cif&quot; ).then( function( comp ){
     *     comp.addRepresentation( &quot;ball+stick&quot;, { multipleBond: true } );
     * } );
     *
     * @param  {String|File|Blob} path - either a URL or an object containing the file data
     * @param  {LoaderParameters} params - loading parameters
     * @param  {Boolean} params.asTrajectory - load multi-model structures as a trajectory
     * @return {Promise} A Promise object that resolves to a {@link StructureComponent},
     *                   a {@link SurfaceComponent} or a {@link ScriptComponent} object,
     *                   depending on the type of the loaded file.
     */
    loadFile( path, params ){

        const p = Object.assign( {}, this.defaultFileParams, params );

        // placeholder component
        let component = new Component( this, p );
        component.name = getFileInfo( path ).name;
        this.addComponent( component );

        // tasks
        const tasks = this.tasks;
        tasks.increment();

        const onLoadFn = function( object ){

            // remove placeholder component
            this.removeComponent( component );

            component = this.addComponentFromObject( object, p );

            if( component.type === &quot;script&quot; ){
                component.run();
            }else if( p.defaultRepresentation ){
                this.defaultFileRepresentation( component );
            }

            tasks.decrement();

            return component;

        }.bind( this );

        const onErrorFn = function( e ){

            component.setStatus( e );
            tasks.decrement();
            throw e;

        };

        const ext = defaults( p.ext, getFileInfo( path ).ext );
        let promise;

        if( ext === &quot;dcd&quot; ){
            promise = Promise.reject( &quot;loadFile: ext &apos;dcd&apos; must be loaded into a structure component&quot; );
        }else{
            promise = autoLoad( path, p );
        }

        return promise.then( onLoadFn, onErrorFn );

    }

    /**
     * Add the given component to the stage
     * @param {Component} component - the component to add
     * @return {undefined}
     */
    addComponent( component ){

        if( !component ){

            Log.warn( &quot;Stage.addComponent: no component given&quot; );
            return;

        }

        this.compList.push( component );

        this.signals.componentAdded.dispatch( component );

    }

    /**
     * Create a component from the given object and add to the stage
     * @param {Script|Shape|Structure|Surface|Volume} object - the object to add
     * @param {ComponentParameters} params - parameter object
     * @return {Component} the created component
     */
    addComponentFromObject( object, params ){

        const CompClass = ComponentRegistry.get( object.type );

        if( CompClass ){
            const component = new CompClass( this, object, params );
            this.addComponent( component );
            return component
        }

        Log.warn( &quot;no component for object type&quot;, object.type );

    }

    /**
     * Remove the given component
     * @param  {Component} component - the component to remove
     * @return {undefined}
     */
    removeComponent( component ){

        const idx = this.compList.indexOf( component );
        if( idx !== -1 ){
            this.compList.splice( idx, 1 );
            component.dispose();
            this.signals.componentRemoved.dispatch( component );
        }

    }

    /**
     * Remove all components from the stage
     * @param  {String} [type] - component type to remove
     * @return {undefined}
     */
    removeAllComponents( type ){

        this.compList.slice().forEach( function( o ){
            if( !type || o.type === type ){
                this.removeComponent( o );
            }
        }, this );

    }

    /**
     * Handle any size-changes of the container element
     * @return {undefined}
     */
    handleResize(){

        this.viewer.handleResize();

    }

    /**
     * Set width and height
     * @param {String} width - CSS width value
     * @param {String} height - CSS height value
     * @return {undefined}
     */
    setSize( width, height ){

        const container = this.viewer.container;

        if( container !== document.body ){
            if( width !== undefined ) container.style.width = width;
            if( height !== undefined ) container.style.height = height;
            this.handleResize();
        }

    }

    /**
     * Toggle fullscreen
     * @param  {Element} [element] - document element to put into fullscreen,
     *                               defaults to the viewer container
     * @return {undefined}
     */
    toggleFullscreen( element ){

        if( !document.fullscreenEnabled &amp;&amp; !document.mozFullScreenEnabled &amp;&amp;
            !document.webkitFullscreenEnabled &amp;&amp; !document.msFullscreenEnabled
        ){
            Log.log( &quot;fullscreen mode (currently) not possible&quot; );
            return;
        }

        const self = this;
        element = element || this.viewer.container;
        this.lastFullscreenElement = element;

        //

        function getFullscreenElement(){
            return document.fullscreenElement || document.mozFullScreenElement ||
                document.webkitFullscreenElement || document.msFullscreenElement;
        }

        function resizeElement(){

            if( !getFullscreenElement() &amp;&amp; self.lastFullscreenElement ){

                const element = self.lastFullscreenElement;
                element.style.width = element.dataset.normalWidth;
                element.style.height = element.dataset.normalHeight;

                document.removeEventListener( &quot;fullscreenchange&quot;, resizeElement );
                document.removeEventListener( &quot;mozfullscreenchange&quot;, resizeElement );
                document.removeEventListener( &quot;webkitfullscreenchange&quot;, resizeElement );
                document.removeEventListener( &quot;MSFullscreenChange&quot;, resizeElement );

                self.handleResize();
                self.signals.fullscreenChanged.dispatch( false );

            }

        }

        //

        if( !getFullscreenElement() ){

            element.dataset.normalWidth = element.style.width;
            element.dataset.normalHeight = element.style.height;
            element.style.width = screen.width + &quot;px&quot;;
            element.style.height = screen.height + &quot;px&quot;;

            if( element.requestFullscreen ){
                element.requestFullscreen();
            }else if( element.msRequestFullscreen ){
                element.msRequestFullscreen();
            }else if( element.mozRequestFullScreen ){
                element.mozRequestFullScreen();
            }else if( element.webkitRequestFullscreen ){
                element.webkitRequestFullscreen();
            }

            document.addEventListener( &quot;fullscreenchange&quot;, resizeElement );
            document.addEventListener( &quot;mozfullscreenchange&quot;, resizeElement );
            document.addEventListener( &quot;webkitfullscreenchange&quot;, resizeElement );
            document.addEventListener( &quot;MSFullscreenChange&quot;, resizeElement );

            this.handleResize();
            this.signals.fullscreenChanged.dispatch( true );

            // workaround for Safari
            setTimeout( function(){ self.handleResize(); }, 100 );

        }else{

            if( document.exitFullscreen ){
                document.exitFullscreen();
            }else if( document.msExitFullscreen ){
                document.msExitFullscreen();
            }else if( document.mozCancelFullScreen ){
                document.mozCancelFullScreen();
            }else if( document.webkitExitFullscreen ){
                document.webkitExitFullscreen();
            }

        }

    }

    /**
     * Set spin
     * @param {Boolean} flag - if true start rocking and stop spinning
     * @return {undefined}
     */
    setSpin( flag ){

        if( flag ){
            this.spinAnimation.resume( true );
            this.rockAnimation.pause( true );
        }else{
            this.spinAnimation.pause( true );
        }

    }

    /**
     * Set rock
     * @param {Boolean} flag - if true start rocking and stop spinning
     * @return {undefined}
     */
    setRock( flag ){

        if( flag ){
            this.rockAnimation.resume( true );
            this.spinAnimation.pause( true );
        }else{
            this.rockAnimation.pause( true );
        }

    }

    /**
     * Toggle spin
     * @return {undefined}
     */
    toggleSpin(){

        this.setSpin( this.spinAnimation.paused );

    }

    /**
     * Toggle rock
     * @return {undefined}
     */
    toggleRock(){

        this.setRock( this.rockAnimation.paused );

    }

    setFocus( value ){

        const clipNear = clamp( value / 2, 0, 49.9 );
        const clipFar = 100 - clipNear;
        const diffHalf = ( clipFar - clipNear ) / 2;

        this.setParameters( {
            clipNear,
            clipFar,
            fogNear: pclamp( clipFar - diffHalf ),
            fogFar: pclamp( clipFar + diffHalf )
        } );

    }

    getZoomForBox( boundingBox ){

        const bbSize = boundingBox.getSize( tmpZoomVector );
        const maxSize = Math.max( bbSize.x, bbSize.y, bbSize.z );
        const minSize = Math.min( bbSize.x, bbSize.y, bbSize.z );
        let distance = maxSize + Math.sqrt( minSize );

        const fov = degToRad( this.viewer.perspectiveCamera.fov );
        const width = this.viewer.width;
        const height = this.viewer.height;
        const aspect = width / height;
        const aspectFactor = ( height &lt; width ? 1 : aspect );

        distance = Math.abs(
            ( ( distance * 0.5 ) / aspectFactor ) / Math.sin( fov / 2 )
        );
        distance += this.parameters.clipDist.value;
        return -distance;

    }

    getBox(){

        return this.viewer.boundingBox;

    }

    getZoom(){

        return this.getZoomForBox( this.getBox() );

    }

    getCenter( optionalTarget ){

        return this.getBox().getCenter( optionalTarget );

    }

    /**
     * Add a zoom and a move animation with automatic targets
     * @param  {Integer} duration - animation time in milliseconds
     * @return {undefined}
     */
    autoView( duration ){

        this.animationControls.zoomMove(
            this.getCenter(),
            this.getZoom(),
            defaults( duration, 0 )
        );

    }

    /**
     * Make image from what is shown in a viewer canvas
     * @param  {ImageParameters} params - image generation parameters
     * @return {Promise} A Promise object that resolves to an image {@link Blob}.
     */
    makeImage( params ){

        const viewer = this.viewer;
        const tasks = this.tasks;

        return new Promise( function( resolve, reject ){

            function makeImage(){
                tasks.increment();
                viewer.makeImage( params ).then( function( blob ){
                    tasks.decrement();
                    resolve( blob );
                } ).catch( function( e ){
                    tasks.decrement();
                    reject( e );
                } );
            }

            tasks.onZeroOnce( makeImage );

        } );

    }

    setImpostor( value ) {

        this.parameters.impostor.value = value;

        const types = [
            &quot;spacefill&quot;, &quot;ball+stick&quot;, &quot;licorice&quot;, &quot;hyperball&quot;,
            &quot;backbone&quot;, &quot;rocket&quot;, &quot;helixorient&quot;, &quot;contact&quot;, &quot;distance&quot;,
            &quot;dot&quot;
        ];

        this.eachRepresentation( function( repr ){

            if( repr.type === &quot;script&quot; ) return;

            if( !types.includes( repr.getType() ) ){
                return;
            }

            const p = repr.getParameters();
            p.disableImpostor = !value;
            repr.build( p );

        } );

    }

    setQuality( value ) {

        this.parameters.quality.value = value;

        const types = [
            &quot;tube&quot;, &quot;cartoon&quot;, &quot;ribbon&quot;, &quot;trace&quot;, &quot;rope&quot;
        ];

        const impostorTypes = [
            &quot;spacefill&quot;, &quot;ball+stick&quot;, &quot;licorice&quot;, &quot;hyperball&quot;,
            &quot;backbone&quot;, &quot;rocket&quot;, &quot;helixorient&quot;, &quot;contact&quot;, &quot;distance&quot;,
            &quot;dot&quot;
        ];

        this.eachRepresentation( function( repr ){

            if( repr.type === &quot;script&quot; ) return;

            const p = repr.getParameters();

            if( !types.includes( repr.getType() ) ){

                if( !impostorTypes.includes( repr.getType() ) ){
                    return;
                }

                if( !p.disableImpostor ){
                    repr.repr.quality = value;
                    return;
                }

            }

            p.quality = value;
            repr.build( p );

        } );

    }

    /**
     * Iterator over each component and executing the callback
     * @param  {Function} callback - function to execute
     * @param  {String}   type - limit iteration to components of this type
     * @return {undefined}
     */
    eachComponent( callback, type ){

        this.compList.slice().forEach( function( o, i ){

            if( !type || o.type === type ){
                callback( o, i );
            }

        } );

    }

    /**
     * Iterator over each representation and executing the callback
     * @param  {Function} callback - function to execute
     * @param  {String}   type - limit iteration to components of this type
     * @return {undefined}
     */
    eachRepresentation( callback, type ){

        this.eachComponent( function( comp ){

            comp.reprList.slice().forEach( function( repr ){
                callback( repr, comp );
            } );

        }, type );

    }

    /**
     * Get collection of components by name
     * @param  {String|RegExp}   name - the component name
     * @param  {String} type - limit iteration to components of this type
     * @return {ComponentCollection} collection of selected components
     */
    getComponentsByName( name, type ){

        const compList = [];

        this.eachComponent( function( comp ){

            if( name === undefined || matchName( name, comp ) ){
                compList.push( comp );
            }

        }, type );

        return new ComponentCollection( compList );

    }

    /**
     * Get collection of components by object
     * @param  {Object} object - the object to find
     * @return {ComponentCollection} collection of selected components
     */
    getComponentsByObject( object ){

        const compList = [];

        this.eachComponent( function( comp ){

            if( comp[ comp.type ] === object ){
                compList.push( comp );
            }

        } );

        return new ComponentCollection( compList );

    }

    /**
     * Get collection of representations by name
     * @param  {String|RegExp}   name - the representation name
     * @param  {String} type - limit iteration to components of this type
     * @return {RepresentationCollection} collection of selected components
     */
    getRepresentationsByName( name, type ){

        let compName, reprName;

        if( typeof name !== &quot;object&quot; || name instanceof RegExp ){
            compName = undefined;
            reprName = name;
        }else{
            compName = name.comp;
            reprName = name.repr;
        }

        const reprList = [];

        this.eachRepresentation( function( repr, comp ){

            if( compName !== undefined &amp;&amp; !matchName( compName, comp ) ){
                return;
            }

            if( reprName === undefined || matchName( reprName, repr ) ){
                reprList.push( repr );
            }

        }, type );

        return new RepresentationCollection( reprList );

    }

    /**
     * Get collection of components and representations by name
     * @param  {String|RegExp}   name - the component or representation name
     * @return {Collection} collection of selected components and representations
     */
    getAnythingByName( name ){

        const compList = this.getComponentsByName( name ).list;
        const reprList = this.getRepresentationsByName( name ).list;

        return new Collection( compList.concat( reprList ) );

    }

    /**
     * Cleanup when disposing of a stage object
     * @return {undefined}
     */
    dispose(){

        this.tasks.dispose();

    }

}


export default Stage;
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-69549173-1', 'auto');
    ga('send', 'pageview');
</script></body>
</html>
